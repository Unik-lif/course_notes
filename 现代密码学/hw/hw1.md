## 现代密码学 - hw1
宋林轲 202418018629018
### 2.6 Prove Lemma 2.7.
First, as a uniform bit $b \in {0, 1}$ given $c$ known to A, $b'$ generated by A, while the true $b$ is unknown to A, we have

$Pr[PrivK_{A, \pi}^{eav} = 1] = Pr[b = b'] = Pr[Enc_{k}(m_{b}) = Enc_{k}(m_{b'})]$

Now, let's prove perfectly secret can imply perfectly indistinguishable. Since LEMMA 2.5 has given the equivalent formulation of perfect secrecy, we will use this instead of the original one.

By definition, perfectly secret means: for every $m, m_0 \in M$, and $\forall c \in C$, we have

$Pr[Enc_{k}(m_0) = c] = Pr[Enc_{k}(m) = c]$

Given $Enc_{k}(m_b) = c$, so 

$Pr[PrivK_{A, \pi}^{eav} = 1] = Pr[Enc_{k}(m_{b'}) = c]$

Since $b$ can only be in {0, 1}, $c$ is from one of the option.

$Pr[Enc_{k}(m_{b'}) = c] + Pr[Enc_{k}(m_{b}) = c] = 1, b' \neq b$

and, 

$Pr[Enc_{k}(m_b) = c] = Pr[Enc_{k}(m_{b'}) = c], b' \neq b$

so, 

$Pr[PrivK_{A, \pi}^{eav} = 1] = Pr[Enc_{k}(m_{b'}) = c] = \frac{1}{2}$

On the other hand.

$Pr[PrivK_{A, \pi}^{eav} = 1] = \frac{1}{2} = Pr[Enc_{k}(m_{b'}) = c] = 1 - Pr[Enc_{k}(m_{b}) = c]$

so,

$Pr[Enc_{k}(m_0) = c] = Pr[Enc_{k}(m) = c]$

### 2.8 

(a). The message space is $M = \{0, \cdots , 4\}$, and $Gen$ chooses a uniform key from the key space $K = \{0, \cdots , 5\}$. $Enc_k(m)$ returns $[m + k \mod 5]$, and $Dec_k(c)$ returns $[c − k \mod 5]$.

Take an example, when $Eve$ gets $C = 0$, the $m, k$ value could be:
- 0, 0
- 4, 1
- 3, 2
- 2, 3
- 1, 4
- 0, 5

So $Pr[M = 0 | C = 0] = \frac{1}{3} \neq Pr[M = 0] = \frac{1}{5}$

(b). The message space is $M = \{m ∈ \{0, 1\}^{l} | the\ last \ bit\ of\ m\ is\ 0\}$. $Gen$ chooses a uniform key from $\{0, 1\}^{l−1}$. $Enc_k(m)$ returns ciphertext $m \oplus (k\|0)$, and $Dec_k(c)$ returns $c \oplus (k\|0)$.

Key K is a uniform $l-1$ bit string that is independent of M. So,

$Pr[C = c | M = m] = Pr[m \oplus (K\|0) = c | M = m] = Pr[(K\|0) = c \oplus m | M = m] = Pr[K = (c \oplus m) \gg 1 | M = m] = 2^{l - 1}$

Besides,

$Pr[C = c] = \sum_{m\in M} Pr[C = c | M = m] \cdot Pr [M = m] = 2 ^{l - 1} \cdot \sum_{m\in M} Pr[M = m] = 2^{l -1}$

So by Bayes' Theorem, this is perfectly secret.

Pr[M = m | C=c] = Pr[M =m]

### 2.14
(a). Prove that if only a single character is encrypted, then the shift cipher is perfectly secret.

First let's prove a single encrypted character with shift cipher will be perfectly secret.

$Pr[C = c | M = m] = Pr[(K + m) \mod 26 = c | M = m] = Pr[K \equiv (c - m) \mod 26 | M = m] = \frac{1}{26}$

$Pr[C =c] = \sum_{m\in M}Pr[C = c | M =m] \cdot Pr[M = m] = \frac{1}{26} \sum_{m\in M} Pr[M = m] = \frac{1}{26}$

So with Bayes' Theorem,

$Pr[M = m | C =c] = Pr[M = m]$

However, as the string grows longer than 1 character, this will not be true. We will use the definition in Lemma 2.5 to prove that.

we select the $m = \{a\}^{n}, m' = \{b, \{a\}^{n-1}\}$, since for any two messages $m, m' \in M$, and every $c \in C$, we should have,

$Pr[Enc_{k}(m) = c] = Pr[Enc_{k}(m') = c]$

However, as we select $c = \{a\}^{n}$, the $k$ has to be $a$ to ensure $Enc_{k}(m) = c$, but $Enc_{k}(m') \neq c$, therefore,

$Pr[Enc_{k}(m) = c] \neq Pr[Enc_{k}(m') = c]$

So (a) is true.


(c). Prove that the Vigen`ere cipher using (fixed) period t is perfectly secret when used to encrypt messages of length t.

By definition,

$K = {k_1, k_2, \cdots k_t}$, $M = {m_1, m_2, \cdots m_t}$, $C = {c_1,c_2, \cdots c_t}$

And,

$c_i = (k_i + m_i) \mod 26, i \in [1, t]$

So, since K and M is independently selected, and every position of k is also independently selected.

$Pr[C = c|M = m] = Pr[K_i + m_i \equiv c_i \mod 26, \forall i \in [1,t] | M = m_0 \cdots m_t] = (\frac{1}{26})^{t}$

$Pr[C = c] = \sum_{m \in M} Pr[C = c | M = m] \cdot Pr[M = m]= (\frac{1}{26})^{t}$

So with Bayes' Theorem,

$Pr[M = m | C =c] = Pr[M = m]$


### 2.15
Give a direct proof that a scheme satisfying Definition 2.6 must have $|K| \ge |M|$. Specifically, let $\pi$ be an arbitrary encryption scheme with $|K| < |M|$. Show an A for which $Pr [PrivK^{eav}_{A,\pi} = 1] > \frac{1}{2}$.  
- Hint: It may be easier to let A be randomized.

We still use Lemma 2.7, therefore if we can conclude that when $|K| < |M|$, $\pi$ will not be perfectly secret, then 
$Pr [PrivK^{eav}_{A,\pi} = 1] > \frac{1}{2}$ will be true.

So, 

$Pr[M = m] = \frac{1}{|M|}$

Since the $k$ only has $|K|$ options, with randomized cases,

$Pr[C = c| M = m] = Pr[Enc_k(m) | M = m] = \frac{1}{|K|} < Pr[M = m]$

Therefore we can conclude that $Pr [PrivK^{eav}_{A,\pi} = 1] > \frac{1}{2}$.

